#! /usr/bin/env bash

if [ "$1" == '-h' -o "$1" == '--help' ]; then
    ARG=""
else
    ARG="$1"
fi

##
# Help for built-in functions. If you're adding a function, you should add some documentation here.
#
case "$ARG" in
    'use' )
        echo 'use: Change the current workspace.'
        echo 'Usage (print current workspace): use'
        echo 'Usage (change current workspace): use <workspace>'
        ;;
    
    'build' | 'buildweb' | 'buildstatic' )
        echo 'build, buildweb, buildstatic: Build files in the current workspace.'
        echo 'Usage: build <command args>...'
        echo 'Arguments will be passed to the build process.'
        ;;
    
    'devbox' )
        echo 'devbox: SSH into your dev instance.'
        ;;
    
    'dbbox' )
        echo 'dbbox: Log into your MySQL database.'
        ;;
    
    'deactivate' )
        echo 'deactivate: Exit ZEnv (also Ctrl+D).'
        echo 'This will exit the current shell, so look out!'
        ;;
    
    '-l' | '--list-utils' )
        echo 'The utilities that work inside ZEnv are:'
        ls -1 "${ZENV_ROOT}/bin"
        echo ''
        echo "For help on individual commands or utils, type 'zhelp <command>'."
        ;;

    '' )
        echo "The current built-in commands are:
use             Change the current workspace.
build           Build something at the root level.
buildweb        Build something at the web/ level.
buildstatic     Build static files.
deactivate      Exit ZEnv.

The current aliases are:
devbox          Log into your dev instance.
dbbox           Log into your database.
install-all     Install everything.
install-most    Install everything except test data.
install-test    Install test data only.
reinstall-all   Delete everything, then reinstall it.
del-work        Completely wipe your dev instance.

The current utilities are:
$(ls -1 "${ZENV_ROOT}/bin")

For help on individual commands or utils, type 'zhelp <command>'. You can also pass -h or --help to utilities."
        ;;

    * )
        if [ -e "${ZENV_ROOT}/bin/$1" ]; then
            "${ZENV_ROOT}/bin/$1" --help
        else
            echo "${1}: Command not found. Help with aliases is not available."
        fi
        ;;
esac
