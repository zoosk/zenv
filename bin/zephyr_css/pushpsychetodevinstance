#! /usr/bin/env bash

if [ "$1" == '-h' -o "$1" == '--help' -o  "$1" == '' ]; then
    echo "Usage: pushpsychetodevinstance [path to your psyche directory]"
    exit 1
fi

cd "$1"

if [ ! -f "package.json" ]; then
    echo "Does not look like a psyche directory. Quitting."
    exit 1
fi

tar -cz * >psyche-dev.tgz
scp psyche-dev.tgz node1dev.sfo2.zoosk.com:/srv/psyche-dev$ZENV_DEVID/current/psyche-dev.tgz
ssh node1dev.sfo2.zoosk.com "tar -xf /srv/psyche-dev$ZENV_DEVID/current/psyche-dev.tgz -C /srv/psyche-dev$ZENV_DEVID/current/"
cd "$ZENV_CURRENT_WORK"
scp build/staticversion.js node1dev.sfo2.zoosk.com:/srv/psyche-dev$ZENV_DEVID/current/config/staticversion.js
ssh node1dev.sfo2.zoosk.com "/srv/psyche-dev$ZENV_DEVID/restart.sh"
