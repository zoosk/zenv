#! /usr/bin/env bash

if [ "$1" == '-h' -o "$1" == '--help' -o "$1" == '' ]; then
    PROGNAME=$(basename $0)
    echo "${PROGNAME}: Run a script from the web/test folder on your dev instance."
    echo "Usage: ${PROGNAME} script_name [script_args...]"
    exit 1
fi

if [ -z "$ZENV_INITIALIZED" ]; then
    echo "You must run this program from within ZEnv."
    exit 1
elif [ -z "$ZENV_CURRENT_WORK" ]; then
    echo 'You must use a checkout before you can run its scripts.'
    exit 1
fi

SCRIPT_NAME="$1"
shift
ssh "$ZENV_LDAP_USERNAME"@"$ZENV_DEVSERVER" "cd ${ZENV_SERVERDIR}/web/test && php ${SCRIPT_NAME} $@"
