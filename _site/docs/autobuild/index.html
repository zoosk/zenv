<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Autobuild</title>
  <meta name="description" content="Bringing ZEN to your dev environment
">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://g.zoosk.com/docs/autobuild/">
  <link rel="alternate" type="application/rss+xml" title="ZENv" href="https://g.zoosk.com/feed.xml">
  <style type="text/css">
    .page-content.hero {
      background-image : url("/images/Zenv_bakground-02.png");
    }
  </style>
</head>


  <body class="page">

    <header class="site-header">
  <span><img class="logo" src="/images/ZENV_brand_logo_only2.png" /></span>
  <div class="categories">
    <span class="category-item"><a href="/">Home</a></span>
    <span class="category-item"><a href="/examples">Examples</a></span>
    <span class="category-item"><a href="/docs/quickstart/">Docs</a></span>
    <span class="category-item bold"><a class="bold" target="_blank" href="https://g.zoosk.com/platform/zenv">GitHub Project</a></span>
  </div>
</header>




    <div class="page-content docs">
        <div class="doc-category">
            <div class="docs">
               <ul class="doc-list">
                  <li>
                     <a href="/docs/quickstart/">Quick Start</a>
                  </li>
                  <li>
                     <a href="/docs/autobuild/">Autobuild</a>
                  </li>
                  <li>
                     <a href="/docs/checkouts/">Checkouts</a>
                  </li>
                  <li>
                     <a href="/docs/environment/">Environment</a>
                  </li>
                  <li>
                     <a href="/docs/installation/">Installation</a>
                  </li>
                  <li>
                     <a href="/docs/variables/">Environment Variables</a>
                  </li>
               </ul>

                <div class="doc-content">
                    <h1 id="the-zenv-auto-builder">The ZEnv Auto Builder</h1>

<p>One of the most useful features that comes with ZEnv is the automatic builder. It watches
your computer for changes that you make to your workspace, then automatically uploads them
to your dev instance when you do. This makes for less time spent compiling and more time
spent debugging.</p>

<h2 id="how-can-i-use-it">How Can I Use it?</h2>

<p>You need to have the Python library called MacFSEvents installed for the builder to run.
To install it, either type <code class="highlighter-rouge">sudo pip install macfsevents</code> or check out
https://pypi.python.org/pypi/MacFSEvents</p>

<p>After that, just run <code class="highlighter-rouge">autobuild</code>.</p>

<h2 id="how-does-it-work">How Does it Work?</h2>

<p>The auto builder uses settings declared in <code class="highlighter-rouge">autobuild_settings</code> files in your checkout.
These files contain shell commands that will be run whenever you do something to a file.
Each settings file contains the rules for all files below it in the directory tree.</p>

<h2 id="a-simple-settings-file">A Simple Settings File</h2>
<hr />

<p>Here is a very simple settings file:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>set TARGET_DIR=${ZENV_SERVERDIR}/public_html

# Directly copy any .jpg files into the target directory
\.jpg$
	addupdate
		cp $0 $TARGET_DIR/$0
		chmod 755 $TARGET_DIR/$0
	delete
		rm $TARGET_DIR/$0
</code></pre>
</div>

<p>The structure of the file is very simple. First, there are one or more lines that begin
with the word “set.” These will create variables that you can use in all of your rules.</p>

<p><strong>NOTE: INDENTATION MATTERS. ALWAYS INDENT LIKE THIS. NEVER DO NOT.</strong></p>

<p>Following the variable setup we have the somewhat strange line <code class="highlighter-rouge">\.jpg$</code>. This is a regex
(oh no) that matches the filename of all .jpg files. This tells the builder that the
following rules are for any files that end with .jpg.</p>

<p>Finally, we have the meat of the code:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>addupdate
    cp $0 $TARGET_DIR/$0
    chmod 755 $TARGET_DIR/$0
</code></pre>
</div>

<p>This section specifies code that will be run when a file is either added or updated. There
are several choices for these “marker” lines:</p>

<ul>
  <li>all</li>
  <li>add</li>
  <li>update</li>
  <li>delete</li>
  <li>addupdate</li>
  <li>adddelete</li>
  <li>updatedelete</li>
</ul>

<p>Following the marker line, we have an (almost) pure bash script that will be run. The only
difference is that the <code class="highlighter-rouge">$0</code> variable has as its value the path of the file that was
changed instead of its normal value of the name of the script being run.</p>

<p>When the above file is run, all .jpg files in your public_html directory will be kept in
sync with the ones in your source repository automatically as soon as you make changes.</p>

<h2 id="advanced-tactics-regex-groups">Advanced Tactics: Regex Groups</h2>

<p>Astute readers may have picked up on that 1) regexes are used to match files, and that 2)
the numeric argument variables from Bash have been replaced. You (may have) guessed it!
Groups that you create in regexes are available as numeric variables in your scripts.
Here’s a quick example:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>picture_of_([a-z]+)\.jpg
    all
        echo $1 is cool
</code></pre>
</div>

<p>In this example, whenever you change a file named <code class="highlighter-rouge">picture_of_robin.jpg</code>, you will get a
log message from the auto builder that says “robin is cool”.</p>

<p>Just what you wanted, right?</p>

                </div>
            </div>
        </div>
    </div>

    <footer class="site-footer">
    <div class="categories">
        <span><img class="logo" src="/images/ZENV_brand_logo_only2.png" /></span>
    </div>
</footer>


  </body>

</html>
